(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ad12dbb"],{"0353":function(e,t,a){"use strict";var o=a("3b23"),i=a.n(o);i.a},"09ca":function(e,t,a){},"232d":function(e,t,a){"use strict";var o=a("09ca"),i=a.n(o);i.a},"3b23":function(e,t,a){},b268:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("breadcrumb-nav"),a("el-form",{ref:"queryValidate",staticClass:"query",attrs:{model:e.query,rules:e.ruleValidate,"label-width":"0"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",[a("el-input",{attrs:{placeholder:e.$t("expExeRecord.enterSearchContent")},model:{value:e.query.query_str,callback:function(t){e.$set(e.query,"query_str",t)},expression:"query.query_str"}})],1)],1),a("el-col",{attrs:{span:16}},[a("el-button",{staticClass:"margin-l30",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.filterListData}},[e._v(" "+e._s(e.$t("common.filter"))+" ")]),a("el-button",{attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:e.resetQueryStrListData}},[e._v(" "+e._s(e.$t("common.reset"))+" ")]),a("el-button",{attrs:{type:"primary",icon:"plus-circle-o"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(" "+e._s(e.$t("image.createImage"))+" ")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"","empty-text":e.$t("common.noData")}},[a("el-table-column",{attrs:{prop:"image","show-overflow-tooltip":!0,label:e.$t("image.imageBase"),"min-width":"150"}}),a("el-table-column",{attrs:{prop:"image_tag","show-overflow-tooltip":!0,label:e.$t("image.imageName"),"min-width":"100"}}),a("el-table-column",{attrs:{prop:"user_name","show-overflow-tooltip":!0,label:e.$t("user.user"),"min-width":"90"}}),a("el-table-column",{attrs:{prop:"model_name","show-overflow-tooltip":!0,label:e.$t("modelList.modelName")}}),a("el-table-column",{attrs:{prop:"version",width:"80","show-overflow-tooltip":!0,label:e.$t("serviceList.modelVersion")}}),a("el-table-column",{attrs:{prop:"creation_timestamp","show-overflow-tooltip":!0,label:e.$t("DI.createTime"),"min-width":"90"}}),a("el-table-column",{attrs:{prop:"last_updated_timestamp","show-overflow-tooltip":!0,label:e.$t("serviceList.updateTime"),"min-width":"90"}}),a("el-table-column",{attrs:{prop:"status","show-overflow-tooltip":!0,"min-width":"90",label:e.$t("DI.status")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("status-tag",{attrs:{status:t.row.status,statusObj:e.statusObj}})]}}])}),a("el-table-column",{attrs:{label:e.$t("common.operation"),width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{attrs:{size:"medium"},on:{command:e.handleCommand}},[a("el-button",{staticClass:"multi-operate-btn",attrs:{type:"text",icon:"el-icon-more",round:""}}),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["COMPLETE"===t.row.status||"FAIL"===t.row.status?a("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("modifyFun",t.row)}},[e._v(e._s(e.$t("common.modify")))]):e._e(),a("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("deleteItem",t.row)}},[e._v(e._s(e.$t("common.delete")))]),"FAIL"===t.row.status?a("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("promptFail",t.row)}},[e._v(e._s(e.$t("image.failureReason")))]):e._e()],1)],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.pageNumber,"page-sizes":e.sizeList,"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.totalPage,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,"custom-class":"dialog-style","close-on-click-modal":!1,width:"900px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.clearDialogForm}},[a("step",{attrs:{step:e.currentStep,"step-list":e.stepList}}),a("el-form",{ref:"formValidate",staticClass:"add-node-form",attrs:{model:e.form,rules:e.ruleValidate,"label-width":"130px"}},[0===e.currentStep?a("div",{key:"step0"},[a("div",{staticClass:"subtitle"},[e._v(" "+e._s(e.$t("DI.basicSettings"))+" ")]),a("el-form-item",{attrs:{label:e.$t("image.imageBase"),prop:"image",maxlength:"225"}},[a("el-input",{attrs:{placeholder:e.$t("image.imageBasePro")},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1),a("el-form-item",{attrs:{label:e.$t("image.imageTag"),prop:"image_tag"}},[a("el-input",{attrs:{placeholder:e.$t("image.imageTagPro")},model:{value:e.form.image_tag,callback:function(t){e.$set(e.form,"image_tag",t)},expression:"form.image_tag"}})],1),a("el-form-item",{attrs:{label:e.$t("image.imageRemark")}},[a("el-input",{attrs:{type:"textarea",placeholder:e.$t("image.imageRemarkPro")},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1):e._e(),1===e.currentStep?a("div",{key:"step1"},[a("div",{staticClass:"subtitle"},[e._v(" "+e._s(e.$t("serviceList.modelSettings"))+" ")]),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("user.userGroup"),prop:"group_id"}},[a("el-select",{attrs:{filterable:!0,placeholder:e.$t("user.userGroupSettingsPro")},on:{change:e.changeGroup},model:{value:e.form.group_id,callback:function(t){e.$set(e.form,"group_id",t)},expression:"form.group_id"}},e._l(e.groupList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),e.form.group_id?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("modelList.modelName"),prop:"model_name"}},[a("el-select",{attrs:{placeholder:e.$t("serviceList.modelNamePro1")},on:{change:e.selectChangeModel},model:{value:e.form.model_name,callback:function(t){e.$set(e.form,"model_name",t)},expression:"form.model_name"}},e._l(e.modelOptionList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.model_name,value:e.id}})})),1)],1)],1):e._e()],1),e.form.model_name?a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("serviceList.modelVersion"),prop:"model_version_id"}},[a("el-select",{attrs:{placeholder:e.$t("serviceList.modelVersionPro")},model:{value:e.form.model_version_id,callback:function(t){e.$set(e.form,"model_version_id",t)},expression:"form.model_version_id"}},e._l(e.versionOptionList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("serviceList.modelType"),prop:"model_type"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.model_type,callback:function(t){e.$set(e.form,"model_type",t)},expression:"form.model_type"}})],1)],1)],1):e._e()],1):e._e()]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.currentStep>0?a("el-button",{attrs:{type:"primary"},on:{click:e.lastStep}},[e._v(" "+e._s(e.$t("common.lastStep"))+" ")]):e._e(),e.currentStep<1?a("el-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v(" "+e._s(e.$t("common.nextStep"))+" ")]):e._e(),1===e.currentStep?a("el-button",{attrs:{disabled:e.btnDisabled,type:"primary"},on:{click:e.subInfo}},[e._v(" "+e._s(e.$t("common.save"))+" ")]):e._e(),a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$t("common.cancel"))+" ")])],1)],1)],1)},i=[],s=(a("a4d3"),a("e01a"),a("d28b"),a("4160"),a("c975"),a("b0c0"),a("dca8"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("3ca3"),a("159b"),a("ddb0"),a("21f4")),r=a("d374"),n=a("6322"),l=a("db15"),m={mixins:[n["a"]],components:{Step:r["a"],StatusTag:l["a"]},data:function(){return{dialogVisible:!1,query:{query_str:""},dataList:[],groupList:[],modify:!1,modelOptionList:[],versionOptionList:[],currentStep:0,form:{image:"",image_tag:"",remarks:"",group_id:"",model_name:"",model_version_id:"",model_type:""},loading:!1,statusObj:{Creating:"",BUILDING:"",PUSHING:"",COMPLETE:"success",FAIL:"danger"}}},mounted:function(){this.getListData(),this.getGroupList()},computed:{noDataText:function(){return this.loading?"":this.$t("common.noData")},stepList:function(){return[this.$t("image.imageBaseInfo"),this.$t("serviceList.modelSettings")]},title:function(){return this.modify?this.$t("image.modifyImage"):this.$t("image.createImage")},ruleValidate:function(){return this.resetQueryFields(),this.resetFormFields(),{image:[{required:!0,message:this.$t("image.imageBaseReq")},{type:"string",pattern:new RegExp(/^[a-z][a-z0-9-_./]*$/),message:this.$t("image.imageBaseFormat")}],image_tag:[{required:!0,message:this.$t("image.imageTagReq")},{type:"string",pattern:new RegExp(/^[a-z0-9A-Z][a-z0-9A-Z-_./]*$/),message:this.$t("image.imageTagFormat")}],group_id:[{required:!0,message:this.$t("user.userGroupSettingsReq")}],model_name:[{required:!0,message:this.$t("modelList.modelNameReq")}],model_version_id:[{required:!0,message:this.$t("serviceList.modelVersionReq")}]}}},methods:{deleteItem:function(e){var t="/mf/v1/image/".concat(e.id);this.deleteListItem(t)},modifyFun:function(e){var t=this;this.modify=!0,this.getModelList(e.group_id);var a={};for(var o in this.form)a[o]=e[o];a.id=e.id;var i=e.model_version.model.id;this.getVersionList(i),a.model_type=e.model_version.model.model_type,a.model_name=i,a.model_version_id+="",this.dialogVisible=!0,setTimeout((function(){t.form=a}),0)},nextStep:function(){var e=this;this.$refs.formValidate.validate((function(t){t&&e.currentStep<e.stepList.length-1&&e.currentStep++}))},promptFail:function(e){this.$alert(e.msg?e.msg:this.$t("common.noData"),this.$t("image.failureReason"))},getListData:function(){var e=this;this.loading=!0;var t="/mf/v1/images",a={page:this.pagination.pageNumber,size:this.pagination.pageSize,query_str:this.query.query_str};this.FesApi.fetch(t,a,"get").then((function(t){t.images&&t.images.forEach((function(e){var t=e.image_name.indexOf(":");e.image=e.image_name.substring(0,t),e.image_tag=e.image_name.substring(t+1),e.creation_timestamp=e.creation_timestamp?s["a"].transDate(e.creation_timestamp):"",e.last_updated_timestamp=e.last_updated_timestamp?s["a"].transDate(e.last_updated_timestamp):"",e.user_name=e.user.name,e.model_name=e.model_version.model.model_name,e.version=e.model_version.version})),e.dataList=Object.freeze(t.images),e.pagination.totalPage=t.total||0,e.loading=!1}),(function(){e.dataList=[],e.loading=!1}))},subInfo:function(){var e=this;this.$refs.formValidate.validate((function(t){if(t){var a={model_version_id:parseInt(e.form.model_version_id),remarks:e.form.remarks},o="post",i="/mf/v1/image";e.modify&&(o="put",i="/mf/v1/image/".concat(e.form.id)),a.group_id=e.form.group_id,a.image_name=e.form.image+":"+e.form.image_tag,a.user_name=localStorage.getItem("userId"),e.setBtnDisabeld(),e.FesApi.fetch(i,a,o).then((function(){e.getListData(),e.toast(),e.dialogVisible=!1}))}}))},changeGroup:function(e){this.form.model_name="",this.form.model_version_id="",this.versionOptionList=[],this.getModelList(e)},getModelList:function(e){var t=this;this.FesApi.fetch("/mf/v1/modelsByGroupID/".concat(e),{page:1,size:1e3},"get").then((function(e){var a=[],o=!0,i=!1,s=void 0;try{for(var r,n=e.models[Symbol.iterator]();!(o=(r=n.next()).done);o=!0){var l=r.value;"CUSTOM"===l.model_type&&a.push(l)}}catch(m){i=!0,s=m}finally{try{o||null==n.return||n.return()}finally{if(i)throw s}}t.modelOptionList=t.formatResList(a)}))},selectChangeModel:function(e){this.form.model_version_id="";var t=!0,a=!1,o=void 0;try{for(var i,s=this.modelOptionList[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var r=i.value;if(r.id===e){this.form.model_type=r.model_type,this.serviceModels={model_name:r.model_name,model_type:r.model_type,group_name:r.group.name};break}}}catch(n){a=!0,o=n}finally{try{t||null==s.return||s.return()}finally{if(a)throw o}}this.getVersionList(e)},getVersionList:function(e){var t=this;this.FesApi.fetch("/mf/v1/modelversions/".concat(e),{page:1,size:1e3},"get").then((function(e){var a=[];if(e.modelVersions){var o=!0,i=!1,s=void 0;try{for(var r,n=e.modelVersions[Symbol.iterator]();!(o=(r=n.next()).done);o=!0){var l=r.value;a.push({id:l.id+"",name:l.version,source:l.source})}}catch(m){i=!0,s=m}finally{try{o||null==n.return||n.return()}finally{if(i)throw s}}}t.versionOptionList=Object.freeze(a)}))},clearDialogForm:function(){var e=this;for(var t in this.currentStep=0,this.modelOptionList=[],this.versionOptionList=[],this.modify=!1,this.form)this.form[t]="";setTimeout((function(){e.$refs.formValidate.resetFields()}),0)}}},d=m,u=(a("cb0c"),a("2877")),c=Object(u["a"])(d,o,i,!1,null,"87c07546",null);t["default"]=c.exports},cb0c:function(e,t,a){"use strict";var o=a("d058"),i=a.n(o);i.a},cbb5:function(e,t,a){},d058:function(e,t,a){},d374:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"step-steps"},[a("ul",e._l(e.stepList,(function(t,o){return a("li",{key:o},[a("span",{class:{"steps-dot":"steps-dot","steps-current":o===e.step,"steps-finish":e.step>o}}),e._v(" "+e._s(t)+" ")])})),0)])},i=[],s=(a("a9e3"),{props:{step:{type:Number,default:function(){return 0}},stepList:{type:Array,default:function(){return[]}}}}),r=s,n=(a("232d"),a("2877")),l=Object(n["a"])(r,o,i,!1,null,"283c0962",null);t["a"]=l.exports},db15:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tag",{attrs:{type:e.statusObj[e.status]}},[e._v(e._s(e.status))])},i=[],s=(a("cbb5"),a("450d"),a("8bbc")),r=a.n(s),n={components:{ElTag:r.a},props:{statusObj:{type:Object,default:function(){return{success:"success",info:"info",warning:"warning",danger:"danger"}}},status:{type:String,default:"success"}},data:function(){return{}}},l=n,m=(a("0353"),a("2877")),d=Object(m["a"])(l,o,i,!1,null,"0d8a0704",null);t["a"]=d.exports}}]);