(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-222afb4e"],{"01d8":function(e,t,o){"use strict";var a=o("ac13"),i=o.n(a);i.a},"4d1c":function(e,t,o){},"4de4":function(e,t,o){"use strict";var a=o("23e7"),i=o("b727").filter,l=o("1dde"),r=o("ae40"),s=l("filter"),n=r("filter");a({target:"Array",proto:!0,forced:!s||!n},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},7761:function(e,t,o){"use strict";var a=o("4d1c"),i=o.n(a);i.a},ac13:function(e,t,o){},ade3:function(e,t,o){"use strict";function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}o.d(t,"a",(function(){return a}))},b64b:function(e,t,o){var a=o("23e7"),i=o("7b0b"),l=o("df75"),r=o("d039"),s=r((function(){l(1)}));a({target:"Object",stat:!0,forced:s},{keys:function(e){return l(i(e))}})},c4f6:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("breadcrumb-nav"),o("el-form",{ref:"queryValidate",staticClass:"query",attrs:{model:e.query}},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",[o("el-input",{attrs:{placeholder:e.$t("expExeRecord.enterSearchContent")},model:{value:e.query.query_str,callback:function(t){e.$set(e.query,"query_str",t)},expression:"query.query_str"}})],1)],1),o("el-col",{attrs:{span:16}},[o("el-button",{staticClass:"margin-l30",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.filterListData}},[e._v(" "+e._s(e.$t("common.filter"))+" ")]),o("el-button",{attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:e.resetQueryStrListData}},[e._v(" "+e._s(e.$t("common.reset"))+" ")]),o("el-button",{attrs:{type:"primary",icon:"plus-circle-o"},on:{click:e.openModel}},[e._v(" "+e._s(e.$t("modelList.createModel"))+" ")])],1)],1)],1),o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"","empty-text":e.$t("common.noData")}},[o("el-table-column",{attrs:{prop:"model_name","show-overflow-tooltip":!0,label:e.$t("modelList.modelName")}}),o("el-table-column",{attrs:{prop:"version","show-overflow-tooltip":!0,label:e.$t("serviceList.modelVersion")}}),o("el-table-column",{attrs:{prop:"model_type","show-overflow-tooltip":!0,label:e.$t("modelList.type")}}),o("el-table-column",{attrs:{prop:"username","show-overflow-tooltip":!0,label:e.$t("user.user")}}),o("el-table-column",{attrs:{prop:"groupName","show-overflow-tooltip":!0,label:e.$t("user.userGroup")}}),o("el-table-column",{attrs:{prop:"update_timestamp","show-overflow-tooltip":!0,label:e.$t("serviceList.updateTime")}}),o("el-table-column",{attrs:{label:e.$t("common.operation"),"min-width":"85"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-dropdown",{attrs:{size:"medium"},on:{command:e.handleCommand}},[o("el-button",{staticClass:"multi-operate-btn",attrs:{type:"text",icon:"el-icon-more",round:""}}),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["MLPipeline"!==t.row.model_type?o("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("updateModel",t.row)}},[e._v(e._s(e.$t("common.modify")))]):e._e(),o("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("deleteItem",t.row)}},[e._v(e._s(e.$t("common.delete")))]),o("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("versionListFun",t.row)}},[e._v(e._s(e.$t("modelList.versionList")))])],1)],1)]}}])})],1),o("el-pagination",{attrs:{"current-page":e.pagination.pageNumber,"page-sizes":e.sizeList,"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.totalPage,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),o("create-model",{ref:"createModelg",attrs:{localPathList:e.localPathList,groupList:e.groupList,modelId:e.modelId},on:{getListData:e.getListData}})],1)},i=[],l=(o("a4d3"),o("e01a"),o("d28b"),o("c975"),o("b0c0"),o("d3b7"),o("3ca3"),o("ddb0"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:e.modify?e.$t("modelList.modifyModel"):e.$t("modelList.createModel"),visible:e.dialogVisible,"custom-class":"dialog-style",width:"1100px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.clearDialogForm}},[o("el-form",{ref:"formValidate",attrs:{model:e.form,rules:e.formValidate,"label-width":"155px"}},[o("div",{staticClass:"subtitle"},[e._v(" "+e._s(e.$t("modelList.basicModelInfo"))+" ")]),o("el-form-item",{attrs:{label:e.$t("modelList.modelName"),prop:"model_name"}},[o("el-input",{attrs:{disabled:e.modify,placeholder:e.$t("modelList.modelNamePro")},model:{value:e.form.model_name,callback:function(t){e.$set(e.form,"model_name",t)},expression:"form.model_name"}})],1),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:e.$t("modelList.belongUserGroup"),prop:"group_id"}},[o("el-select",{attrs:{filterable:"",placeholder:e.$t("modelList.belongUserGroupPro")},model:{value:e.form.group_id,callback:function(t){e.$set(e.form,"group_id",t)},expression:"form.group_id"}},e._l(e.groupList,(function(e,t){return o("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:e.$t("serviceList.modelType"),prop:"model_type"}},[o("el-select",{attrs:{disabled:e.modify,placeholder:e.$t("serviceList.modelTypePro")},on:{change:e.changeModelType},model:{value:e.form.model_type,callback:function(t){e.$set(e.form,"model_type",t)},expression:"form.model_type"}},[o("el-option",{attrs:{label:"Tensorflow",value:"TENSORFLOW"}}),o("el-option",{attrs:{label:"SKLearn",value:"SKLEARN"}}),o("el-option",{attrs:{label:"XGBoost",value:"XGBOOST"}}),o("el-option",{attrs:{label:e.$t("modelList.custom"),value:"CUSTOM"}})],1)],1)],1)],1),o("div",{staticClass:"subtitle"},[e._v(" "+e._s(e.$t("modelList.modelLocationinfo"))+" ")]),o("el-form-item",{attrs:{label:e.$t("serviceList.modelLocation"),prop:"modelLocation"}},[o("el-select",{attrs:{placeholder:e.$t("DI.uploadModeSettingsPro")},model:{value:e.form.modelLocation,callback:function(t){e.$set(e.form,"modelLocation",t)},expression:"form.modelLocation"}},[o("el-option",{attrs:{label:e.$t("DI.manualUpload"),value:"codeFile"}}),o("el-option",{attrs:{label:e.$t("serviceList.shareDirectory"),value:"HDFSPath"}})],1)],1),"HDFSPath"===e.form.modelLocation?o("div",{key:"HDFSPath"},[o("el-form-item",{attrs:{label:e.$t("modelList.storageRootPath"),prop:"root_path"}},[o("el-select",{attrs:{filterable:"",placeholder:e.$t("modelList.storageRootPathPro")},model:{value:e.form.root_path,callback:function(t){e.$set(e.form,"root_path",t)},expression:"form.root_path"}},e._l(e.localPathList,(function(e,t){return o("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),o("el-form-item",{attrs:{label:e.$t("modelList.fileStorageSubpath"),prop:"child_path"}},[o("el-input",{attrs:{placeholder:e.$t("modelList.fileStorageSubpathPro")},model:{value:e.form.child_path,callback:function(t){e.$set(e.form,"child_path",t)},expression:"form.child_path"}})],1)],1):e._e(),"codeFile"===e.form.modelLocation&&e.dialogVisible?o("div",{key:"codeFile",staticClass:"tofs-upload"},[e.form.model_type?o("upload",{attrs:{"margin-left":155,baseUrl:e.baseUrl,"file-size":2048,params:e.params,allType:!0,transferParam:!0,codeFile:e.file_name},on:{deleteFile:e.deleteFile,uploadFile:e.uploadFile}}):e._e()],1):e._e()],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.subInfo}},[e._v(" "+e._s(e.$t("common.save"))+" ")]),o("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$t("common.cancel"))+" ")])],1)],1)}),r=[],s=(o("4de4"),o("4160"),o("a9e3"),o("e439"),o("dbb4"),o("b64b"),o("4d63"),o("ac1f"),o("25f0"),o("159b"),o("ade3")),n=o("d443");function d(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function m(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?d(Object(o),!0).forEach((function(t){Object(s["a"])(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var c={components:{Upload:n["a"]},props:{modelId:{type:Number,default:0},localPathList:{type:Array,default:function(){return[]}},groupList:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!1,form:{model_name:"",group_id:"",model_type:"",modelLocation:"codeFile",root_path:"",child_path:""},params:{},modify:!1,changeFile:!1,source:"",file_name:"",baseUrl:"/mf/v1/model/uploadModel"}},computed:{formValidate:function(){return this.resetFormFields(),{model_name:[{required:!0,message:this.$t("modelList.modelNameReq")},{type:"string",pattern:new RegExp(/^[a-zaA-Z][a-zA-Z0-9-]*$/),message:this.$t("modelList.modelNameFormat")}],group_id:[{required:!0,message:this.$t("modelList.belongUserGroupReq")}],model_type:[{required:!0,message:this.$t("serviceList.modelTypeReq")}],modelLocation:[{required:!0,message:this.$t("serviceList.deploymentTypeReq")}],root_path:[{required:!0,message:this.$t("modelList.storageRootPathReq")}],child_path:[{required:!0,message:this.$t("modelList.fileStorageSubpathReq")},{type:"string",pattern:new RegExp(/^\/[a-zA-Z][0-9a-zA-Z-._/]*$/),message:this.$t("modelList.fileStorageSubpathFormat")}]}}},methods:{subInfo:function(){var e=this;this.$refs.formValidate.validate((function(t){if(t){var o=m({},e.form);if(o.group_id=parseInt(o.group_id),delete o.modelLocation,"codeFile"===e.form.modelLocation){if(!e.source)return void e.$message(e.$t("modelList.uploadFileReq"));o.s3_path=e.source,o.file_name=e.file_name,delete o.root_path,delete o.child_path}var a="post",i="/mf/v1/model";e.modify&&(a="put",i+="/"+e.modelId),e.FesApi.fetch(i,o,a).then((function(t){e.toast(),e.$emit("getListData"),e.dialogVisible=!1}))}}))},changeModelType:function(e){this.params.modelType=e},deleteFile:function(){this.source="",this.file_name=""},uploadFile:function(e,t){this.modify&&(this.changeFile=!0),this.source=e.result.s3Path,this.file_name=e.fileName},clearDialogForm:function(){var e=this;for(var t in this.deleteFile(),this.modify=!1,this.changeFile=!1,this.form)console.log("key",t),this.form[t]="";this.deleteFile(),setTimeout((function(){e.$refs.formValidate.resetFields(),e.form.modelLocation="codeFile"}),0)}}},u=c,p=(o("01d8"),o("2877")),f=Object(p["a"])(u,l,r,!1,null,"59700139",null),h=f.exports,g=o("6322"),b=o("21f4"),y={mixins:[g["a"]],components:{CreateModel:h},data:function(){return{query:{query_str:""},userOptionList:[],localPathList:[],groupList:[],dataList:[],modelId:0,verPagination:{pageNumber:1,pageSize:10,pagination:0}}},mounted:function(){this.getListData(),this.getDIUserOption(),this.getDIStoragePath(),this.getGroupList()},methods:{openModel:function(){this.$refs.createModelg.dialogVisible=!0},getListData:function(){var e=this,t={page:this.pagination.pageNumber,size:this.pagination.pageSize,query_str:this.query.query_str};this.FesApi.fetch("/mf/v1/models",t,"get").then((function(t){var o=!0,a=!1,i=void 0;try{for(var l,r=t.models[Symbol.iterator]();!(o=(l=r.next()).done);o=!0){var s=l.value;s.update_timestamp=b["a"].transDate(s.update_timestamp),s.username=s.user.name,s.groupName=s.group.name,s.groupId=s.group.id,s.version=s.model_latest_version.version}}catch(n){a=!0,i=n}finally{try{o||null==r.return||r.return()}finally{if(a)throw i}}e.dataList=e.formatResList(t),e.pagination.totalPage=t.total||0}))},deleteItem:function(e){var t="/mf/v1/model/".concat(e.id);this.deleteListItem(t)},updateModel:function(e){var t=this.$refs.createModelg;t.modify=!0,this.modelId=e.id;var o={};for(var a in t.form)o[a]=e[a];var i=e.model_latest_version;if(i.filepath){o.modelLocation="HDFSPath";var l=!0,r=!1,s=void 0;try{for(var n,d=this.localPathList[Symbol.iterator]();!(l=(n=d.next()).done);l=!0){var m=n.value;if(i.filepath.indexOf(m)>-1){o.root_path=m,o.child_path=i.filepath.substring(m.length);break}}}catch(c){r=!0,s=c}finally{try{l||null==d.return||d.return()}finally{if(r)throw s}}}else t.params.modelType=e.model_type,t.source=i.source,t.file_name=i.file_name,o.modelLocation="codeFile";t.dialogVisible=!0,setTimeout((function(){t.form=o}))},versionListFun:function(e){this.$router.push("/model/versionList/".concat(e.id))},verHandleSizeChange:function(e){this.verPagination.pageSize=e,this.getListData()},verHandleCurrentChange:function(e){this.verPagination.pageNumber=e,this.getListData()},initVersionPage:function(){this.verPagination.size=10,this.verPagination.pageNumber=1}}},v=y,_=Object(p["a"])(v,a,i,!1,null,null,null);t["default"]=_.exports},d443:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{key:"codeFile",staticClass:"upload-box"},[e.fileName?o("span",{staticClass:"file-name",style:"margin-left:"+e.marginLeft+"px;"},[e._v(" "+e._s(e.fileName)+" "),e.readonly?e._e():o("i",{staticClass:"el-icon-close delete-file",on:{click:function(t){return e.deleteFile()}}})]):e._e(),e.baseUrl?o("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:e.uploadUrl,disabled:e.loading||e.readonly,headers:e.header,"on-success":e.uploadFile,data:e.param,"before-upload":e.beforeUpload,"on-error":e.errrUpload}},[o("el-button",{attrs:{type:"primary",loading:e.loading}},[e._v(" "+e._s(e.$t("DI.manualUpload"))+" ")])],1):o("el-upload",{staticClass:"upload",attrs:{action:"#",disabled:e.loading||e.readonly,"http-request":e.uploadFile,"before-upload":e.beforeUpload,"on-error":e.errrUpload}},[o("el-button",{attrs:{type:"primary",loading:e.loading}},[e._v(" "+e._s(e.$t("DI.manualUpload"))+" ")])],1)],1)},i=[],l=(o("c975"),o("b0c0"),o("a9e3"),{props:{baseUrl:{type:String,default:""},fileKey:{type:String,default:""},marginLeft:{type:Number,default:178},codeFile:{type:String,default:""},fileSize:{type:Number,default:512},dssHeader:{type:Object,default:function(){return{}}},allType:{type:Boolean,default:!1},transferParam:{type:Boolean,default:!1},params:{type:Object,default:function(){return{}}},readonly:{type:Boolean,default:!1}},data:function(){return{fileName:"",loading:!1,uploadUrl:this.baseUrl,header:{"Mlss-Userid":localStorage.getItem("userId")},param:{}}},watch:{params:function(e){e.modelType&&(this.fileName="",this.$emit("deleteFile",this.fileKey))}},mounted:function(){this.fileName=this.codeFile,this.dssHeader["MLSS-AppID"]&&(Object.assign(this.header,this.dssHeader),delete this.header["Content-Type"])},methods:{deleteFile:function(){this.fileName="",this.$emit("deleteFile",this.fileKey)},uploadFile:function(e,t){if(this.loading=!1,e){var o="";this.baseUrl?(o=e,o.fileName=t.name,this.fileName=t.name):(this.fileName=e.file.name,o=e.file),this.$emit("uploadFile",o,this.fileKey)}},beforeUpload:function(e){var t=!0,o=!1;this.allType?o=!0:(t=e.type.indexOf("zip")>-1,t||this.$message.error(this.$t("common.fileFormat")),o=t);var a=e.size/1024/1024<this.fileSize,i=""===this.fileName;return a||this.$message.error(this.$t("common.fileSize"+this.fileSize+"BM")),i?(o&&a&&a&&(this.transferParam&&(this.param.fileName=e.name,Object.assign(this.param,this.params)),this.loading=!0),o&&a):(this.$message.error(this.$t("common.fileLimit")),!1)},errrUpload:function(e){var t=JSON.parse(e.message);this.$message.error(t),this.loading=!1}}}),r=l,s=(o("7761"),o("2877")),n=Object(s["a"])(r,a,i,!1,null,"2b5e895c",null);t["a"]=n.exports},dbb4:function(e,t,o){var a=o("23e7"),i=o("83ab"),l=o("56ef"),r=o("fc6a"),s=o("06cf"),n=o("8418");a({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){var t,o,a=r(e),i=s.f,d=l(a),m={},c=0;while(d.length>c)o=i(a,t=d[c++]),void 0!==o&&n(m,t,o);return m}})},e439:function(e,t,o){var a=o("23e7"),i=o("d039"),l=o("fc6a"),r=o("06cf").f,s=o("83ab"),n=i((function(){r(1)})),d=!s||n;a({target:"Object",stat:!0,forced:d,sham:!s},{getOwnPropertyDescriptor:function(e,t){return r(l(e),t)}})}}]);