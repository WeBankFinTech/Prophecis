(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d4f35f84"],{"0353":function(e,t,a){"use strict";var i=a("3b23"),s=a.n(i);s.a},"28e0":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"align-right"},[a("el-button",{attrs:{type:"primary"},on:{click:e.openList}},[e._v(" "+e._s(e.$t("DI.enterCodeDirectory"))+" ")])],1),a("el-dialog",{attrs:{title:"notebook",visible:e.dialogVisible,"custom-class":"dialog-style aide-list-dialog","append-to-body":"",width:"1200px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"","empty-text":e.$t("common.noData")}},[a("el-table-column",{attrs:{prop:"name",label:e.$t("DI.name"),"min-width":"100"}}),a("el-table-column",{attrs:{prop:"user",label:e.$t("user.user")}}),a("el-table-column",{attrs:{prop:"namespace",label:e.$t("ns.nameSpace"),"min-width":"220"}}),a("el-table-column",{attrs:{prop:"cpu",label:e.$t("AIDE.cpu"),"min-width":"50"}}),a("el-table-column",{attrs:{prop:"gpu",label:e.$t("AIDE.gpu"),"min-width":"50"}}),a("el-table-column",{attrs:{prop:"memory",label:e.$t("AIDE.memory1"),"min-width":"70"}}),a("el-table-column",{attrs:{prop:"image",label:e.$t("DI.image"),"min-width":"300"}}),a("el-table-column",{attrs:{prop:"status",label:e.$t("DI.status")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("status-tag",{attrs:{status:t.row.status,statusObj:e.statusObj}})]}}])}),a("el-table-column",{attrs:{prop:"uptime",label:e.$t("DI.createTime"),"min-width":"125"}}),a("el-table-column",{attrs:{label:e.$t("common.operation"),"min-width":"85"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{attrs:{size:"medium"},on:{command:e.handleCommand}},[a("el-button",{staticClass:"multi-operate-btn",attrs:{type:"text",icon:"el-icon-more",round:""}}),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("visitNotebook",t.row),disabled:"Ready"!==t.row.status}},[e._v(e._s(e.$t("AIDE.access")))])],1)],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.pageNumber,"page-sizes":e.sizeList,"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.totalPage,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},s=[],o=(a("99af"),a("4160"),a("c975"),a("b0c0"),a("dca8"),a("159b"),a("21f4")),n=a("db15"),r={"Content-Type":"application/json","X-Watson-Userinfo":"bluemix-instance-id=test-user","MLSS-AppTimestamp":"1603274993343","MLSS-AppID":"MLFLOW","MLSS-Auth-Type":"SYSTEM","MLSS-APPSignature":"91a585402398b4c3f63ab26b30722cfc2a74e3b3"},l={components:{StatusTag:n["a"]},props:{rootPath:{type:String,default:""},storagePath:{type:String,default:""}},data:function(){return{dialogVisible:!1,dataList:[],userId:localStorage.getItem("userId"),statusObj:{Ready:"success",Waiting:"",Terminate:"danger"}}},methods:{openList:function(){this.dialogVisible=!0,this.getListData()},getListData:function(){var e=this,t="",a={page:this.pagination.pageNumber,size:this.pagination.pageSize,workDir:"/"+this.rootPath},i=localStorage.getItem("superAdmin");t="true"===i?"/aide/".concat(this.FesEnv.aideApiVersion,"/namespaces/null/user/null/notebooks"):"/aide/".concat(this.FesEnv.aideApiVersion,"/user/").concat(this.userId,"/notebooks");var s={method:"get"};window.location.href.indexOf("contextID")>-1&&(s.headers=r),this.FesApi.fetch(t,a,s).then((function(t){t&&"{}"!==JSON.stringify(t)&&(t.list&&t.list.forEach((function(e){var t=e.image.indexOf(":");e.image=e.image.substring(t+1),e.gpu=e.gpu||0,e.uptime=e.uptime?o["a"].transDate(e.uptime):"",e.queue&&(e.cluster=!0)})),e.dataList=Object.freeze(t.list),e.pagination.totalPage=t.total||0)}),(function(){e.dataList=[]}))},visitNotebook:function(e){var t="/cc/".concat(this.FesEnv.ccApiVersion,"/auth/access/namespaces/").concat(e.namespace,"/notebooks/").concat(e.name),a=new XMLHttpRequest;a.open("GET",t,!1);var i={"Mlss-Userid":this.userId};for(var s in window.location.href.indexOf("contextID")>-1&&(i=r),i)a.setRequestHeader(s,i[s]);var o=this;a.onreadystatechange=function(e){if(4===this.readyState&&200===this.status){var t=JSON.parse(this.responseText).result;if(t.notebookAddress){o.dialogVisible=!1;var a=t.notebookAddress+"/lab/tree/"+o.storagePath;window.open(window.encodeURI(a))}}else{var i=JSON.parse(this.responseText);401===this.status||403===this.status?this.fetchError[this.status](i):this.$Message.error(i.message)}},a.send()}}},d=l,u=(a("345b"),a("2877")),c=Object(u["a"])(d,i,s,!1,null,"8f4b4e86",null);t["a"]=c.exports},"345b":function(e,t,a){"use strict";var i=a("b87f"),s=a.n(i);s.a},"3b23":function(e,t,a){},"4d1c":function(e,t,a){},7761:function(e,t,a){"use strict";var i=a("4d1c"),s=a.n(i);s.a},b87f:function(e,t,a){},cbb5:function(e,t,a){},d364:function(e,t,a){"use strict";a("a4d3"),a("e01a"),a("d28b"),a("99af"),a("c975"),a("a434"),a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0");var i=a("21f4");t["a"]={methods:{gpuBeforeUpload:function(e){var t=e.type.indexOf("zip")>-1,a=e.size/1024/1024<512,i=""===this.files;return t||this.$message.error(this.$t("common.fileFormat")),a||this.$message.error(this.$t("common.fileSize")),i?t&&a:(this.$message.error(this.$t("common.fileLimit")),!1)},gpuDeleteFile:function(){this.files="",this.fileName=""},gpuUploadFile:function(e){e.file&&(this.fileName=e.file.name,this.files=e.file)},handleGPUSubParam:function(){var e={name:this.form.name,description:this.form.description,version:"1.0",gpus:+this.form.gpus,cpus:+this.form.cpus,memory:this.form.memory+"Gb",namespace:this.form.namespace,code_selector:this.form.codeSettings,job_type:this.form.job_type,data_stores:[{id:"hostmount",type:"mount_volume",training_data:{container:this.form.trainingData},training_results:{container:this.form.trainingResults},connection:{type:"host_mount",name:"host-mount",path:this.form.path}}],framework:{name:this.FesEnv.DI.defineImage,version:"Standard"===this.form.imageType?this.form.imageOption:this.form.imageInput,command:this.form.command},evaluation_metrics:{type:"fluent-bit"}};return e},hdpAddExecutorsTask:function(e){var t=this.hdpTaskBaseObj(),a=this.form[e].length;a>=1&&this.hdpAddExecutorsValidate(e,a),this.form[e].push(t)},hdpDeleteExecutorsTask:function(e){var t=this.form[e].length;this.form[e].splice(t-1,1),t>1&&this.hdpDeleteExecutorsValidate(e,t)},hdpAddExecutorsValidate:function(e,t){this.ruleValidate["".concat(e,"[").concat(t,"].HDFSPath")]=this.ruleValidate["".concat(e,"[0].HDFSPath")]},hdpDeleteExecutorsValidate:function(e,t){delete this.ruleValidate["".concat(e,"[").concat(t-1,"].HDFSPath")]},hdpSubmitUpload:function(e,t){var a="".concat(e,"Upload").concat(t);this.$refs[a][0].submit(),this.currentUplod.uploadModule=e,this.currentUplod.index=t},hdpBeforeUpload:function(e){var t=e.type.indexOf("zip")>-1,a=e.size/1024/1024<512,i=this.currentUplod.uploadModule,s="",o=this.currentUplod.index;return s=""===this.form[i][o].fileName,t||this.$message.error(this.$t("common.fileFormat")),a||this.$message.error(this.$t("common.fileSize")),s?t&&a:(this.$message.error(this.$t("common.fileLimit")),!1)},hdpDeleteFile:function(e,t){this.form[e][t].fileName=""},hadUploadFile:function(e,t){if(e.data){var a=this.currentUplod.uploadModule,i=this.currentUplod.index;this.form[a][i].fileName=t.raw.name}},handleHdpSubParam:function(){for(var e={version:"1.0",job_type:"tfos",code_selector:"storagePath",framework:{name:"uat.sf.dockerhub.stgwebank/webank/mlss-di",version:"tfosexecutor-1.6.0"},evaluation_metrics:{type:"fluent-bit"}},t=["name","namespace","description"],a=0,i=t;a<i.length;a++){var s=i[a];e[s]=this.form[s]}this.handelHdpTfos(e);for(var o=["queue","executor_cores","executor_memory","driver_memory","executors","command"],n=0,r=o;n<r.length;n++){var l=r[n];e.tfos_request[l]=this.form[l]}return e},handelHdpTfos:function(e){var t=["pyfile","archives"];e.tfos_request={pyfile:[],archives:[]};for(var a=i["a"].getTime(),s=this.FesEnv.DI.definePython,o=0,n=t;o<n.length;o++){var r=n[o],l=!0,d=!1,u=void 0;try{for(var c,m=this.form[r][Symbol.iterator]();!(l=(c=m.next()).done);l=!0){var p=c.value;if("codeFile"===p.codeSettings&&p.fileName){var f="".concat(s,"/").concat(this.userId,"/").concat(a,"/").concat(p.fileName);e.tfos_request[r].push({hdfs:f})}else"HDFSPath"===p.codeSettings&&p.HDFSPath&&e.tfos_request[r].push({hdfs:p.HDFSPath})}}catch(g){d=!0,u=g}finally{try{l||null==m.return||m.return()}finally{if(d)throw u}}}var h="Standard"===this.form.pythonType?this.form.pythonOption:this.form.pythonInput;e.tfos_request.tensorflow_env={hdfs:h}},validateForm:function(){var e=!1;return this.$refs.formValidate.validate((function(t){e=t})),e}}}},d443:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{key:"codeFile",staticClass:"upload-box"},[e.fileName?a("span",{staticClass:"file-name",style:"margin-left:"+e.marginLeft+"px;"},[e._v(" "+e._s(e.fileName)+" "),e.readonly?e._e():a("i",{staticClass:"el-icon-close delete-file",on:{click:function(t){return e.deleteFile()}}})]):e._e(),e.baseUrl?a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:e.uploadUrl,disabled:e.loading||e.readonly,headers:e.header,"on-success":e.uploadFile,data:e.param,"before-upload":e.beforeUpload,"on-error":e.errrUpload}},[a("el-button",{attrs:{type:"primary",loading:e.loading}},[e._v(" "+e._s(e.$t("DI.manualUpload"))+" ")])],1):a("el-upload",{staticClass:"upload",attrs:{action:"#",disabled:e.loading||e.readonly,"http-request":e.uploadFile,"before-upload":e.beforeUpload,"on-error":e.errrUpload}},[a("el-button",{attrs:{type:"primary",loading:e.loading}},[e._v(" "+e._s(e.$t("DI.manualUpload"))+" ")])],1)],1)},s=[],o=(a("c975"),a("b0c0"),a("a9e3"),{props:{baseUrl:{type:String,default:""},fileKey:{type:String,default:""},marginLeft:{type:Number,default:178},codeFile:{type:String,default:""},fileSize:{type:Number,default:512},dssHeader:{type:Object,default:function(){return{}}},allType:{type:Boolean,default:!1},transferParam:{type:Boolean,default:!1},params:{type:Object,default:function(){return{}}},readonly:{type:Boolean,default:!1}},data:function(){return{fileName:"",loading:!1,uploadUrl:this.baseUrl,header:{"Mlss-Userid":localStorage.getItem("userId")},param:{}}},watch:{params:function(e){e.modelType&&(this.fileName="",this.$emit("deleteFile",this.fileKey))}},mounted:function(){this.fileName=this.codeFile,this.dssHeader["MLSS-AppID"]&&(Object.assign(this.header,this.dssHeader),delete this.header["Content-Type"])},methods:{deleteFile:function(){this.fileName="",this.$emit("deleteFile",this.fileKey)},uploadFile:function(e,t){if(this.loading=!1,e){var a="";this.baseUrl?(a=e,a.fileName=t.name,this.fileName=t.name):(this.fileName=e.file.name,a=e.file),this.$emit("uploadFile",a,this.fileKey)}},beforeUpload:function(e){var t=!0,a=!1;this.allType?a=!0:(t=e.type.indexOf("zip")>-1,t||this.$message.error(this.$t("common.fileFormat")),a=t);var i=e.size/1024/1024<this.fileSize,s=""===this.fileName;return i||this.$message.error(this.$t("common.fileSize"+this.fileSize+"BM")),s?(a&&i&&i&&(this.transferParam&&(this.param.fileName=e.name,Object.assign(this.param,this.params)),this.loading=!0),a&&i):(this.$message.error(this.$t("common.fileLimit")),!1)},errrUpload:function(e){var t=JSON.parse(e.message);this.$message.error(t),this.loading=!1}}}),n=o,r=(a("7761"),a("2877")),l=Object(r["a"])(n,i,s,!1,null,"2b5e895c",null);t["a"]=l.exports},db15:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tag",{attrs:{type:e.statusObj[e.status]}},[e._v(e._s(e.status))])},s=[],o=(a("cbb5"),a("450d"),a("8bbc")),n=a.n(o),r={components:{ElTag:n.a},props:{statusObj:{type:Object,default:function(){return{success:"success",info:"info",warning:"warning",danger:"danger"}}},status:{type:String,default:"success"}},data:function(){return{}}},l=r,d=(a("0353"),a("2877")),u=Object(d["a"])(l,i,s,!1,null,"0d8a0704",null);t["a"]=u.exports}}]);