(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23c0ce54"],{"4c4d":function(e,t,i){},"891c":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("breadcrumb-nav"),i("el-form",{ref:"queryValidate",staticClass:"query",attrs:{model:e.query}},[i("el-row",[i("el-col",{attrs:{span:8}},[i("el-form-item",[i("el-input",{attrs:{placeholder:e.$t("expExeRecord.enterSearchContent")},model:{value:e.query.query_str,callback:function(t){e.$set(e.query,"query_str",t)},expression:"query.query_str"}})],1)],1),i("el-col",{attrs:{span:16}},[i("el-button",{staticClass:"margin-l30",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.filterListData}},[e._v(" "+e._s(e.$t("common.filter"))+" ")]),i("el-button",{attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:e.resetListData}},[e._v(" "+e._s(e.$t("common.reset"))+" ")]),i("el-button",{attrs:{type:"primary",icon:"plus-circle-o"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(" "+e._s(e.$t("distribute.creationExpriment"))+" ")]),i("el-button",{attrs:{type:"primary",icon:"plus-circle-o"},on:{click:e.showGPU}},[e._v(" "+e._s(e.$t("distribute.createDLTask"))+" (GPU) ")])],1)],1)],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"","empty-text":e.$t("common.noData")}},[i("el-table-column",{attrs:{prop:"exp_name","show-overflow-tooltip":!0,label:e.$t("distribute.experimentName")}}),i("el-table-column",{attrs:{prop:"group_name","show-overflow-tooltip":!0,label:e.$t("user.userGroup")}}),i("el-table-column",{attrs:{prop:"exp_desc","show-overflow-tooltip":!0,label:e.$t("distribute.experimentDesc")}}),i("el-table-column",{attrs:{prop:"tag_str","show-overflow-tooltip":!0,label:e.$t("distribute.experimentTag")}}),i("el-table-column",{attrs:{prop:"dss_dss_project_name","show-overflow-tooltip":!0,label:e.$t("distribute.projectName")}}),i("el-table-column",{attrs:{prop:"dss_dss_flow_name","show-overflow-tooltip":!0,label:e.$t("distribute.workflowName")}}),i("el-table-column",{attrs:{prop:"create_type",width:"85","show-overflow-tooltip":!0,label:e.$t("DI.type")}}),i("el-table-column",{attrs:{prop:"dss_dss_flow_version","show-overflow-tooltip":!0,label:e.$t("distribute.workflowVersion")}}),i("el-table-column",{attrs:{prop:"exp_create_time","show-overflow-tooltip":!0,label:e.$t("distribute.createTime")}}),i("el-table-column",{attrs:{prop:"exp_modify_time","show-overflow-tooltip":!0,label:e.$t("distribute.updateTime")}}),i("el-table-column",{attrs:{prop:"createUserName","show-overflow-tooltip":!0,label:e.$t("distribute.creator")}}),i("el-table-column",{attrs:{prop:"modifyUserName","show-overflow-tooltip":!0,label:e.$t("distribute.modifier")}}),i("el-table-column",{attrs:{label:e.$t("common.operation"),width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-dropdown",{attrs:{size:"medium"},on:{command:e.handleCommand}},[i("el-button",{staticClass:"multi-operate-btn",attrs:{type:"text",icon:"el-icon-more",round:""}}),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("editeFlow",t.row)}},[e._v(e._s(e.$t("distribute.experimentEdit")))]),i("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("runExperiment",t.row)}},[e._v(e._s(e.$t("distribute.experimentExecution")))]),i("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("deleteItem",t.row)}},[e._v(e._s(e.$t("distribute.deleteExperiment")))]),i("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("downloadFlow",t.row)}},[e._v(e._s(e.$t("distribute.exportExperiment")))]),i("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("toExperimentHistory",t.row)}},[e._v(e._s(e.$t("distribute.executionHistory")))]),i("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("updateItem",t.row)}},[e._v(e._s(e.$t("distribute.informationEdit")))]),i("el-dropdown-item",{attrs:{command:e.beforeHandleCommand("addRecord",t.row)}},[e._v(e._s(e.$t("distribute.tracking")))])],1)],1)]}}])})],1),i("el-pagination",{attrs:{"current-page":e.pagination.pageNumber,"page-sizes":e.sizeList,"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.totalPage,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),i("el-dialog",{attrs:{title:e.modify?e.$t("distribute.modifyExpriment"):e.$t("distribute.creationExpriment"),visible:e.dialogVisible,"custom-class":"dialog-style",width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.clearDialogForm}},[i("el-form",{ref:"formValidate",staticClass:"add-form",attrs:{model:e.form,rules:e.ruleValidate,"label-width":"120px"}},[i("el-form-item",{attrs:{label:e.$t("distribute.creationWay"),prop:"type"}},[i("el-select",{attrs:{placeholder:e.$t("distribute.creationWayTip")},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[i("el-option",{attrs:{value:"flow",label:e.$t("distribute.visualEditing")}}),i("el-option",{attrs:{value:"import",label:e.$t("distribute.externalImport")}})],1)],1),"flow"===e.form.type?i("div",[i("el-form-item",{attrs:{label:e.$t("distribute.experimentName"),placeholder:e.$t("distribute.experimentNameTip"),prop:"exp_name"}},[i("el-input",{model:{value:e.form.exp_name,callback:function(t){e.$set(e.form,"exp_name",t)},expression:"form.exp_name"}})],1),i("el-form-item",{attrs:{label:e.$t("user.userGroup"),placeholder:"请选择项目组",prop:"group_name"}},[i("el-select",{attrs:{filterable:""},model:{value:e.form.group_name,callback:function(t){e.$set(e.form,"group_name",t)},expression:"form.group_name"}},e._l(e.groupList,(function(e,t){return i("el-option",{key:t,attrs:{value:e.name,label:e.name}})})),1)],1),i("el-form-item",{attrs:{label:e.$t("distribute.experimentTag")}},[e._l(e.form.tag_list,(function(t,a){return i("el-tag",{key:a,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return e.handleClose(t)}}},[e._v(" "+e._s(t.exp_tag)+" ")])})),e.inputVisible?i("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"mini"},on:{click:e.showInput}},[e._v("+ "+e._s(e.$t("label.addlabels")))])],2),i("el-form-item",{attrs:{label:e.$t("distribute.experimentDesc"),prop:"exp_desc"}},[i("el-input",{attrs:{type:"textarea",placeholder:e.$t("distribute.experimentDescTip")},model:{value:e.form.exp_desc,callback:function(t){e.$set(e.form,"exp_desc",t)},expression:"form.exp_desc"}})],1)],1):i("div",[i("el-upload",{staticClass:"upload",attrs:{drag:"",action:e.baseUrl,headers:{"Mlss-Userid":e.userId},data:e.uploadParam,"before-upload":e.beforeUpload,"on-success":e.uploadSuccess,"on-error":e.uploadError}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[e._v(e._s(e.$t("distribute.dragFile"))),i("em",[e._v(e._s(e.$t("distribute.clickUpload")))])]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.$t("distribute.uploadFileTip")))])])],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",disabled:e.btnDisable||"import"===e.form.type},on:{click:e.subInfo}},[e._v(e._s(e.$t("common.save")))]),i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))])],1)],1),i("create-gpu",{ref:"gpuDialog",attrs:{spaceOptionList:e.spaceOptionList,localPathList:e.localPathList}})],1)},o=[],r=(i("a4d3"),i("e01a"),i("d28b"),i("99af"),i("4160"),i("c975"),i("a434"),i("dca8"),i("b64b"),i("d3b7"),i("4d63"),i("ac1f"),i("25f0"),i("3ca3"),i("159b"),i("ddb0"),i("cbb5"),i("450d"),i("8bbc")),s=i.n(r),n=i("6322"),l=i("1246"),p=i("21f4"),u={mixins:[n["a"]],components:{ElTag:s.a,CreateGpu:l["a"]},data:function(){return{query:{query_str:""},dialogVisible:!1,spaceOptionList:[],localPathList:[],dataList:[],groupList:[],form:{type:"flow",group_name:"",tag_list:[],exp_name:"",exp_desc:"",id:""},uploadParam:{},deleteTagArr:[],inputVisible:!1,inputValue:"",fileSize:100,fileName:"",btnDisable:!1,modify:!1,userId:localStorage.getItem("userId")}},computed:{getUrl:function(){return"/di/".concat(this.FesEnv.diApiVersion,"/experiments")},baseUrl:function(){return"".concat("","/di/").concat(this.FesEnv.diApiVersion,"/experiment/import")},ruleValidate:function(){return this.resetFormFields(),{type:[{required:!0,message:this.$t("distribute.creationWayNoEmpty")}],exp_name:[{required:!0,message:this.$t("distribute.experimentNameNoEmpty")},{pattern:new RegExp(/^[a-zA-Z][0-9a-zA-Z-_]*$/),message:this.$t("distribute.experimentNameReg")}],exp_desc:[{required:!0,message:this.$t("distribute.experimentDescReq")}],group_name:[{required:!0,message:this.$t("ns.userGroupReq")}]}}},mounted:function(){this.getListData(),this.getDISpaceOption(),this.getDIStoragePath(),this.getGroupList()},methods:{showGPU:function(){this.$refs.gpuDialog.dialogVisible=!0},getListData:function(){var e=this,t={page:this.pagination.pageNumber,size:this.pagination.pageSize,username:localStorage.getItem("userId")};this.query.query_str&&(t.query_str=this.query.query_str),this.FesApi.fetch(this.getUrl,t,"get").then((function(t){t.experiments&&t.experiments.forEach((function(e){if(e.tag_list){e.tag_str=e.tag_list[0].exp_tag;for(var t=1;t<e.tag_list.length;t++)e.tag_str+=","+e.tag_list[t].exp_tag}e.exp_create_time=p["a"].transDate(new Date(e.exp_create_time).getTime()),e.exp_modify_time=p["a"].transDate(new Date(e.exp_modify_time).getTime()),e.createUserName=e.create_user.Name,e.modifyUserName=e.modify_user.Name})),e.dataList=Object.freeze(t.experiments),e.pagination.totalPage=t.total||0}))},subInfo:function(){var e=this;this.$refs.formValidate.validate((function(t){if(t){e.btnDisable=!0;var i="post",a={exp_name:e.form.exp_name,group_name:e.form.group_name,exp_desc:e.form.exp_desc,tag_list:e.form.tag_list},o="/di/".concat(e.FesEnv.diApiVersion,"/experiment");e.modify&&(i="put",o+="/".concat(e.form.id)),e.FesApi.fetch(o,a,i).then((function(t){e.toast(),e.dialogVisible=!1,e.btnDisable=!1,e.modify?e.getListData():e.$router.push({name:"experimentFlow",query:{readonly:!1,exp_id:t.id,exp_name:t.exp_name}})}),(function(){e.btnDisable=!1}))}}))},deleteItem:function(e){var t="/di/".concat(this.FesEnv.diApiVersion,"/experiment/").concat(e.id);this.deleteListItem(t)},updateItem:function(e){var t=this;this.dialogVisible=!0,this.modify=!0,this.uploadParam.experimentId=e.id,setTimeout((function(){var i={};Object.keys(t.form).forEach((function(t){i[t]=e[t]})),i.type="flow";var a=[];if(e.tag_list){var o=!0,r=!1,s=void 0;try{for(var n,l=e.tag_list[Symbol.iterator]();!(o=(n=l.next()).done);o=!0){var p=n.value;a.push({exp_id:p.exp_id,exp_tag:p.exp_tag})}}catch(u){r=!0,s=u}finally{try{o||null==l.return||l.return()}finally{if(r)throw s}}}i.tag_list=a,t.form=i}),0)},editeFlow:function(e){this.$router.push({name:"experimentFlow",query:{readonly:"WTSS"===e.create_type,exp_id:e.id,exp_name:e.exp_name}})},addRecord:function(e){this.$router.push("/experiment/addRecord/"+e.mlflow_exp_id)},handleClose:function(e){for(var t=this.form.tag_list,i=0;i<t.length;i++)e.exp_tag===t[i].exp_tag&&this.form.tag_list.splice(i,1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var e=this.inputValue;e&&this.form.tag_list.push({exp_id:-1,exp_tag:e}),this.inputVisible=!1,this.inputValue=""},uploadFile:function(e){this.$message.success(this.$t("distribute.uploadSuccess"))},downloadFlow:function(e){var t="".concat("","/di/v1/experiment/").concat(e.id,"/export");this.downFile(t,e.exp_name)},beforeUpload:function(e){var t=e.type.indexOf("zip")>-1,i=e.size/1024/1024<this.fileSize,a=""===this.fileName;return t||this.$message.error(this.$t("common.fileFormat")),i||this.$message.error(this.$t("common.fileSize"+this.fileSize+"BM")),a?(t&&i&&i&&(this.loading=!0),t&&i):(this.$message.error(this.$t("common.fileLimit")),!1)},runExperiment:function(e){var t=this;this.FesApi.fetch("/di/".concat(this.FesEnv.diApiVersion,"/experimentRun/").concat(e.id),{exp_exec_type:"MLFLOW"},"post").then((function(i){t.$router.push({name:"experimentFlow",query:{exp_name:e.exp_name,readonly:!0,exp_id:e.id,exec_id:i.id}})}))},uploadSuccess:function(e){this.$router.push({name:"experimentFlow",query:{exp_name:e.result.exp_name,readonly:!1,exp_id:e.result.id}})},uploadError:function(e){var t=JSON.parse(e.message);this.$message.error(t.result)},toExperimentHistory:function(e){this.$router.push({name:"expExeRecord",query:{exp_id:e.id}})},clearDialogForm:function(){var e=this;this.modify=!1,this.form.tag_list=[],this.form.exp_desc="",delete this.form.exp_id,setTimeout((function(){e.$refs.formValidate.resetFields()}),0)},resetListData:function(){this.pagination.pageNumber=1,this.query.query_str="",this.$refs.queryValidate.resetFields(),this.getListData()}}},d=u,m=(i("dffc"),i("2877")),c=Object(m["a"])(d,a,o,!1,null,"e7b7f954",null);t["default"]=c.exports},dffc:function(e,t,i){"use strict";var a=i("4c4d"),o=i.n(a);o.a}}]);